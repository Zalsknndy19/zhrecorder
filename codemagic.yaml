# FILE: codemagic.yaml (VERSI PALING STABIL & STANDAR)

workflows:
  android-app-build:
    name: Build ZHRecorder APK
    
    # KOSONGKAN 'instance_type'. Biarkan Codemagic memilih mesin
    # gratis terbaik yang tersedia untukmu. Ini adalah cara yang paling aman.
    
    environment:
      # Cukup minta grup 'android-sdk'.
      # Ini akan secara otomatis menyertakan Java, Gradle, dan semua
      # variabel lingkungan yang benar, termasuk JAVA_HOME yang valid.
      groups:
        - android-sdk

    scripts:
      - name: Build APK with Gradle
        script: | 
          # Pindah ke direktori root proyekmu
          cd $CM_BUILD_DIR
          # Beri izin eksekusi pada Gradle wrapper
          chmod +x ./gradlew
          # Jalankan build
          ./gradlew assembleDebug --no-daemon
          
    artifacts:
      # Cari .apk di dalam direktori 'app/build/'
      - app/build/outputs/apk/**/*.apk